<!DOCTYPE html>
<html lang="en">

<head>
    <title>Purple Buzz - Contact Page</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" href="assets/img/apple-icon.png">
    <link rel="shortcut icon" type="image/x-icon" href="assets/img/favicon.ico">
    <!-- Load Require CSS -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font CSS -->
    <link href="assets/css/boxicon.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600&display=swap" rel="stylesheet">
    <!-- Load Tempalte CSS -->
    <link rel="stylesheet" href="assets/css/templatemo.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="assets/css/custom.css">
    <!--

    TemplateMo 561 Purple Buzz

    https://templatemo.com/tm-561-purple-buzz

    -->
</head>

<body>
<!-- Header -->
<nav id="main_nav" class="navbar navbar-expand-lg navbar-light bg-white shadow">
    <div class="container d-flex justify-content-between align-items-center">
        <a class="navbar-brand h1" href="index.html">
            <i class='bx bx-buildings bx-sm text-dark'></i>
            <span class="text-dark h4">派蒙</span> <span class="text-primary h4">校园交友网站</span>
        </a>
        <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbar-toggler-success" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="align-self-center collapse navbar-collapse flex-fill  d-lg-flex justify-content-lg-between"
             id="navbar-toggler-success">
            &nbsp;<h1>欢迎来到管理页面</h1>
            <div class="navbar align-self-center d-flex">
                <button type="submit"
                        class="btn btn-secondary rounded-pill px-md-5 px-4 py-2 radius-0 text-light light-300"><a
                        href="index.html">切换至用户模式</a></button>
            </div>
        </div>
    </div>
</nav>
<!-- Close Header -->

<!-- Start Contact -->
<section id="university">
    <div class="container py-4">
    <div class="row align-items-center justify-content-between">
        <div class="contact-header col-lg-4">
            <h1 class="h2 pb-3 text-primary">实名认证管理</h1>
            <h3 class="h4 regular-400"></h3>
            <p class="light-300">
                在这里审核用户实名认证信息
            </p>
        </div>
    </div>
    <div class="row pb-4" id="checknamelist">
        <div class="worksingle-comment-body col-md-8 m-auto" v-for="(item,index) in data" :key="index">
            <div class="d-flex">
                <div>
                    <img class="rounded-circle" :src="item.image" style="width: 50px;">
                    <button class="button2" style="margin-left: 650px" @click="agreecheck(item.uid)">通过</button>
                    <button class="button1" @click="refusecheck(item.uid)">驳回</button>
                </div>
                <div class="comment-body">
                    <div class="comment-header d-flex justify-content-between ms-3">
                        <div class="header text-start">
                            <h5 class="h6">{{item.unick}}</h5>
                            <p class="text-muted light-300">{{item.time}}</p>
                        </div>
                    </div>
                    <div class="footer">
                        <div class="card-body border ms-3 light-300">
                            {{item.uname}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>

        <!-- End Comment -->

</section>
<!-- End Contact -->
<div class="row">
    <div class="btn-toolbar justify-content-center pb-4" role="toolbar" aria-label="Toolbar with button groups">
        <div class="btn-group me-2" role="group" aria-label="First group">
            <button type="button" class="btn btn-secondary text-white" onclick="firstPage()">首页</button>
        </div>
        <div class="btn-group" role="group" aria-label="Third group">
            <button type="button" class="btn btn-secondary text-white" onclick="forward()">上一页</button>
        </div>
        <div class="btn-group me-2" role="group" aria-label="Second group">
            <button type="button" class="btn btn-light">1</button>
        </div>
        <!--            <div class="btn-group me-2" role="group" aria-label="Second group">-->
        <!--                <button type="button" class="btn btn-secondary text-white">2</button>-->
        <!--            </div>-->
        <div class="btn-group" role="group" aria-label="Third group">
            <button type="button" class="btn btn-secondary text-white" onclick="nextPage()">下一页</button>
        </div>
    </div>
</div>


<!-- Start Banner Hero -->
<section class="bg-light">
    <div class="container py-4">
        <div class="row align-items-center justify-content-between">
            <div class="contact-header col-lg-4">
                <h1 class="h2 pb-3 text-primary">用户管理</h1>
                <h3 class="h4 regular-400"></h3>
                <p class="light-300">
                    在这里管理用户信息
                </p>
            </div>
        </div>
        <div class="col-lg-6 mb-4">
            <div class="form-floating">
                <input type="text" class="form-control form-control-lg light-300" id="floatingname" name="inputname"
                       placeholder="Name">
                <label for="floatingname light-300">输入用户信息</label>
            </div>
            <br>
            <button type="submit" class="btn btn-secondary rounded-pill px-md-5 px-4 py-2 radius-0 text-light light-300"
                    onclick="finduser()">查询
            </button>


        </div><!-- End Input Name -->
        <div class="col-lg-4">

            <div class="contact row mb-4" id="userpart">
                <div class="contact-icon col-lg-3 col-3">
                    <div class="py-3 mb-2 text-center border rounded text-secondary">
                        <!--                            <i class='display-6 bx bx-news'></i>-->
                        <img src="" style="width: 85px;height: 85px">
                    </div>

                </div>
                <ul class="contact-info list-unstyled col-lg-9 col-9  light-300">
                    <li class="h5 mb-0">用户A</li>
                    <li class="text-muted"></li>


                    <button type="submit"
                            class="btn btn-secondary rounded-pill px-md-5 px-4 py-2 radius-0 text-light light-300"
                            onclick="frozen()">冻结账户
                    </button>
                </ul>
            </div>


        </div>
    </div>
</section>
<!-- End Banner Hero -->



<!-- Bootstrap -->
<script src="assets/js/bootstrap.bundle.min.js"></script>
<!-- Templatemo -->
<script src="assets/js/templatemo.js"></script>
<!-- Custom -->
<script src="assets/js/custom.js"></script>
<script src="js/jquery-3.3.1.min.js"></script>
<script src = "vue/vue.js"></script>

<script>
    var str = window.location.href;
    var url = "page"
    var pat = new RegExp("(?<="+url+"=)\\w*","g"); //输出url=后面的内容
    page = str.match(pat)[0] //取可能的第一个值

    document.getElementsByClassName("btn btn-light").item(0).innerHTML = page;

    function frozen() {
        var uid = document.getElementById("userpart").getElementsByTagName("li").item(1).innerText;
        if (uid == '') {
            alert("请先查询用户")
        } else {
            $.get("user?method=frozenUser", "uid=" + uid, function (data) {
                alert(data)
            })
        }
    }

    function finduser() {
        var username = document.getElementById("floatingname").value;
        $.get("user?method=getuserbyname", "unick=" + username, function (data) {
            data = JSON.parse(data);
            document.getElementById("userpart").getElementsByTagName("img").item(0).setAttribute("src", data.image)
            document.getElementById("userpart").getElementsByTagName("li").item(0).innerText = data.unick;
            document.getElementById("userpart").getElementsByTagName("li").item(1).innerText = data.uid;
        })
    }


    //初始化好友留言消息
    new Vue({
        el: '#checknamelist',
        data() {
            return {
                data: {
                    data: ""
                }
            }
        },
        beforeCreate() {
            const data1 = this;
            $.get("user?method=getUserNameInfo", "page="+page, function (data) {
                data1.data = eval("(" + data + ")");
            })
        },
        methods:{
            agreecheck(uid){
                $.get("user?method=checkuname","uid="+uid+"&result=agree",function (data){
                    alert(data);
                })
            },
            refusecheck(uid){
                $.get("user?method=checkuname","uid="+uid+"&result=refuse",function (data){
                    alert(data);
                })
            }
        }

    })


    function nextPage(){
        var page1 = parseInt(page)+1;
        window.location.href="admin.html?page="+page1;
    }
    function forward(){
        var page2 = parseInt(page)-1;
        window.location.href="admin.html?page="+page2;
    }
    function firstPage(){
        window.location.href="admin.html?page=1";
    }

</script>

</body>

</html>